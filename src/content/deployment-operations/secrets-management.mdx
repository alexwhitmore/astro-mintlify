---
title: 'Secrets Management'
date: '2024-06-28'
description: 'Learn how to manage secrets in your Epic Stack application for both local development and production environments.'
draft: false
type: 'deployment-ops'
---

import GroupName from '../../components/docs/GroupName.astro'
import CodeBlock from '../../components/docs/CodeBlock.astro'

<GroupName>Deployment & Operations</GroupName>

# Secrets Management

Managing secrets in the Epic Stack is done using environment variables and the `fly secrets` command.

> **Warning**: It is very important that you do NOT hard code any secrets in the source code. Even if your app source is not public, there are many reasons this is dangerous. In the Epic Stack, we default to creating source maps which will reveal your hard-coded secrets to the public. Read more about this in [the source map decision document](./decisions/016-source-maps.md).

## Local Development

When adding a new secret:

1. Add a line to your `.env.example` file:

   - This informs others that the secret is necessary.
   - Use a non-real value as this file is committed to the repository.

2. Follow the "Offline Development" [guiding principle](./guiding-principles.md):

   - Strive to make it possible to mock out the service you're interacting with using MSW in the `test/mocks` directory.

3. For local testing with real services:
   - Put the real value of the secret in `.env` (which is `.gitignore`d).

Example `.env.example`:

<CodeBlock
  code={`# Example .env.example
TITO_API_SECRET=your_tito_api_secret_here`}
  lang='env'
/>

## Production Secrets

To publish a secret to your production and staging applications:

1. Use the `fly secrets set` command.

For example, to set the `TITO_API_SECRET` secret:

<CodeBlock
  code={`fly secrets set TITO_API_SECRET=some_secret_value
fly secrets set TITO_API_SECRET=some_secret_value --app [YOUR_STAGING_APP_NAME]`}
  lang='bash'
/>

This will redeploy your app with the new environment variable set.

## Best Practices

1. Never commit real secrets to version control.
2. Use different secrets for development, staging, and production environments.
3. Rotate secrets regularly for enhanced security.
4. Limit access to production secrets to only those who absolutely need it.
5. Use a secrets manager for more complex applications or team environments.

By following these practices and using the provided tools, you can effectively manage secrets in your Epic Stack application, ensuring security across all environments.
