---
title: 'Timezone Handling'
date: '2024-06-28'
description: 'Learn how the Epic Stack handles timezones for server-side rendering and client-side hydration without compromising user experience.'
draft: false
type: 'Best Practices'
---

import GroupName from '../../components/docs/GroupName.astro'
import CodeBlock from '../../components/docs/CodeBlock.astro'

<GroupName>Best Practices</GroupName>

# Timezone Handling

Handling timezones in server-rendered applications has traditionally been challenging. The Epic Stack provides a solution that avoids common pitfalls and ensures a consistent user experience.

## Common Pitfalls

Traditional approaches often lead to suboptimal solutions:

- Rendering in UTC
- Rendering in the server's timezone
- Rendering server-side, then hydrating client-side (causes flash of incorrect content)
- Avoiding server-side rendering of time (flash of incomplete content)
- Only rendering time on user interaction (compromised UX)

## The Epic Stack Solution

Thanks to the Epic Stack's built-in support for [client hints](./client-hints.md), we can render time correctly both server-side and client-side without any content flashes or hydration errors.

## Using Timezone Information

### Server-Side Code

In server-side only code, you can access the user's timezone like this:

<CodeBlock
  code={`import { getHints } from '~/utils/client-hints'

// In your server-side function
const { timeZone } = getHints(request)
`}
lang="typescript"
/>

### UI Code

In UI components, you can use the `useHints` hook:

<CodeBlock
  code={`import { useHints } from '~/utils/client-hints'

function MyComponent() {
const { timeZone } = useHints()
// Use timeZone in your component
}
`}
lang="typescript"
/>

## Utility Function

The Epic Stack provides a `getDateTimeFormat` utility that returns a [`DateTimeFormat`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/DateTimeFormat) object in the user's timezone:

<CodeBlock
  code={`import { getDateTimeFormat } from '~/utils/misc'

// In your server-side function
const dateTimeFormat = getDateTimeFormat(request)
const formattedDate = dateTimeFormat.format(new Date())
`}
lang="typescript"
/>

This utility also uses the `accept-language` header to determine the user's preferred locale.

## Using Third-Party Libraries

If you prefer to use a third-party library for date and time formatting, you can still leverage the timezone information from client hints:

<CodeBlock
  code={`import { format } from 'date-fns-tz'
import { getHints } from '~/utils/client-hints'

// In your server-side function
const { timeZone } = getHints(request)
const formattedDate = format(new Date(), 'PPpp', { timeZone })
`}
lang="typescript"
/>

## Best Practices

1. Always use the user's timezone when displaying dates and times.
2. Leverage client hints to ensure consistent rendering between server and client.
3. Use the provided `getDateTimeFormat` utility for simple cases.
4. For more complex formatting needs, consider using a robust date-time library along with the timezone information from client hints.
5. Test your application with users in different timezones to ensure correct behavior.

By following these practices and utilizing the Epic Stack's timezone handling capabilities, you can provide a seamless and accurate time-based experience for your users, regardless of their location.
