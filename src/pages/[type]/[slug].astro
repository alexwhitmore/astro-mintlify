---
import { getCollection, type CollectionEntry } from 'astro:content'
import type { CollectionTypes } from '../../config/site'
import DocumentationLayout from '../../layouts/DocumentationLayout.astro'
import { getCollections } from '../../lib/collections'

export async function getStaticPaths() {
  const collections = getCollections()
  const allPages = await Promise.all(
    collections.map(async (collection) => {
      const pages = await getCollection(collection)
      return pages.map((page) => ({
        params: { type: collection, slug: page.slug },
        props: { page, type: collection },
      }))
    })
  )
  return allPages.flat()
}

type Props = {
  page: CollectionEntry<CollectionTypes>
  type: CollectionTypes
}

const { page, type } = Astro.props
const { Content } = await page.render()
---

<DocumentationLayout title={page.data.title} toc={[]}>
  <Content />
</DocumentationLayout>
